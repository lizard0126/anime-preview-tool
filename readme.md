# 🌟 天央动漫社节操部 · 新番导视图片生成工具

一个专为 **天央动漫社节操部新番导视活动** 打造的自动化配图工具。
通过导入评论 .docx 文档，结合用户头像和番剧视觉图，快速生成**高质量导视图**！

---

## 📦 环境要求

* Node.js **v22**
* 推荐系统：Windows + Edge（或任意 Chromium 浏览器）
* 第一次使用请安装依赖（命令行中运行）：

```bash
npm install cheerio ejs fs-extra mammoth puppeteer-core --save
```

如未安装 Edge，请修改 `templates/screenshot-html.js` 中的 `CHROME_PATH` 指向本地浏览器路径。

---

## 🚀 使用方法

1. 将 `.docx` 评论文档放入项目根目录（支持多文档，默认读取**最新修改**的一个）。
2. 双击运行 `run.bat` 一键生成导视图：

   * 提取文档数据 → 渲染 HTML → 生成截图
3. 所有导视图保存在 `screenshots/` 文件夹。
4. 若需清除旧数据，运行 `del.bat`。

---

## 📌 注意事项

### 🖼 头像命名规范

* 头像文件放入 `output/assets/avatar/`
* 文件名需为 `昵称.jpg`，与评论昵称一致
* 若要标注【金牌】等，评论时昵称需为 `昵称【金牌】：后续文字`

### 📝 文档格式建议

* 替换动画中日标题和评论内容中的全角冒号 `：` 为半角 `:`
* 评论昵称后需为全角冒号 `：`
* 图片评论**在图片前后换行**，避免提取失败

---

## ❓ 常见问题

> **Q: 评论头像没显示？**
> 请检查头像命名与路径是否正确（`.jpg`，`output/assets/avatar/`）。

> **Q: 评论图没截图？**
> 在 `.docx` 中为图片前后加回车，以便正确提取。

> **Q: 运行脚本一闪而过？**
> 请右键使用“以管理员身份运行 CMD”，或手动执行 `run.bat` 观察报错。

---

## 📮 联系作者

* 📧 邮箱：`825456471@qq.com`
* 🐙 GitHub：[anime-preview-tool](https://github.com/lizard0126/anime-preview-tool)

---

🎉 感谢使用！欢迎 ⭐Star、提建议或提交 PR 优化页面样式！