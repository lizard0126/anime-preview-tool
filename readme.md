# 🌟 天央动漫社节操部新番导视图片生成工具

## 项目介绍

本项目用于自动生成天央动漫社节操部新番导视活动的配图，
通过导入评论 `.docx` 文档，结合头像资源和视觉图，快速制作包含评论与图片的精美导视图。

---

## 📖 目录

* [环境准备](#环境准备)
* [使用流程](#使用流程)
* [注意事项](#注意事项)
* [常见问题](#常见问题)
* [联系方式](#联系方式)

---

## 环境准备

* Node.js 16 及以上版本
* Windows 操作系统（推荐）
* 推荐使用较新版本的 EDGE 浏览器
* 如未安装EDGE请修改 `screenshot-html.js` 中的 `CHROME_PATH` 指向本地Chrome内核浏览器
* 项目依赖如下（运行前通过 `npm install` 安装）：

```json
    "cheerio": "^1.0.0-rc.12",
    "ejs": "^3.1.9",
    "fs-extra": "^11.1.1",
    "mammoth": "^1.6.0",
    "puppeteer-core": "^21.3.8"
```

---

## 使用流程

1. **打开项目文件夹**
   将 `.docx` 评论文档放置于项目根目录中（可多个，将自动读取最后修改的一个）。

2. **运行脚本生成截图**
   双击 `run.bat`，系统将自动执行以下操作：

   * 解析 `.docx` 文件生成数据；
   * 渲染 HTML 页面；
   * 自动截图并保存到 `screenshot` 文件夹。

3. **清理临时文件**
   生成图片后，如需清除临时数据和输出文件，可运行 `del.bat`。

---

## ⚠️ 注意事项

* **头像资源需手动准备**
  评论用户头像需自行保存至 `assets/avatar/` 文件夹中。
  【金牌】【银牌】【黑牌】头像需额外单独保存，并根据 `【金牌】姓名.jpg` 的格式命名。

* **冒号标题识别问题**
  当前版本对动画标题中含有冒号（`：`）的内容解析可能出错，可能被误识别为评论。
  解决方案：请手动编辑 `data.json` 中的错误内容，删除或修正异常字段。

* **截图文件夹：**
  所有生成的图片保存在根目录的 `screenshot` 文件夹中，请注意备份或另存。

---

## ❓ 常见问题

* **Q:** 为什么评论头像没有显示？
  **A:** 请确认头像图片为 `.jpg` 格式，已正确命名，并放置于 `assets/avatar/` 文件夹中。

* **Q:** 评论中包含图片，但截图没有？
  **A:** 请确认 `.docx` 文档中图片前后均添加换行符，不要与文字处在同一段落内。

* **Q:** 运行脚本失败，窗口瞬间关闭？
  **A:** 建议使用 CMD 手动运行 `run.bat` 查看错误信息以便排查问题。

---

## 联系方式

如有疑问或建议，欢迎通过以下方式联系：

* 📧 邮箱：`825456471@eqq.com`
* 🐙 GitHub Issues：[anime-preview-tool](https://github.com/lizard0126/anime-preview-tool)

---

感谢使用本项目！🎉
如有任何建议或反馈，欢迎提出改进意见。