# 🌟 天央动漫社节操部 · 新番导视图片生成工具

一个专为 **天央动漫社节操部新番导视活动** 打造的自动化配图工具。
通过导入评论 `.docx` 文档，结合用户头像和番剧视觉图，快速生成**高质量导视图**！

---

## 📁 项目目录

* [⚙️ 环境准备](#️-环境准备)
* [🚀 使用流程](#-使用流程)
* [⚠️ 注意事项](#️-注意事项)
* [❓ 常见问题](#-常见问题)
* [📮 联系方式](#-联系方式)

---

## ⚙️ 环境准备

* Node.js **v20+**
* 推荐操作系统：**Windows**
* 推荐浏览器：**Microsoft Edge**（或其他 Chrome 内核浏览器）
* 如未安装 Edge，请修改 `screenshot-html.js` 中的 `CHROME_PATH` 指向本地浏览器路径

### 📦 项目依赖（请先执行 `npm install`）：

```json
"cheerio": "^1.0.0-rc.12",
"ejs": "^3.1.9",
"fs-extra": "^11.1.1",
"mammoth": "^1.6.0",
"puppeteer-core": "^21.3.8"
```

---

## 🚀 使用流程

1. **准备文档**

   * 将评论 `.docx` 文件放入项目根目录。
   * 支持多个文档，系统默认读取**最新修改**的一个。

2. **一键生成导视图**

   * 运行 `run.bat`，自动完成：

     * `.docx` → JSON 数据解析；
     * HTML 渲染；
     * 页面截图并输出至 `screenshot` 文件夹。

3. **清理临时数据**

   * 若需清除缓存和旧文件，运行 `del.bat`。

---

## ⚠️ 注意事项

### 🖼️ 头像准备

* 请将用户头像放入 `output/assets/avatar/` 文件夹。
* 文件名需与评论中昵称**一致**，格式为 `.jpg`。
* 可运行 `avatar.bat` 自动生成【金牌】【银牌】【黑牌】三种标记头像。
* 系统会跳过已存在标记的文件，支持**重复执行**。

### 📝 标题解析提示

* 当前版本在处理标题或评论中含全角冒号（`：`）时可能误识别为评论。
* 建议提前修改 `.docx` 文件，替换全角冒号（`：`）为半角冒号 （`:`）。
* 或修改 `data.json`，完成后运行 `debug.bat` 继续生成图片。

### 📸 截图输出

* 所有导视图保存在根目录下的 `screenshot/` 文件夹。
* 请注意备份，如需整理建议另存为压缩包或移动到其他目录。

---

## ❓ 常见问题

### Q: 为什么评论头像没有显示？

**A:** 请确保头像文件为 `.jpg`，命名正确并已放入 `output/assets/avatar/`。若评论人名带有【金牌】等标签，需运行 `avatar.bat` 自动生成带标签的头像副本。

---

### Q: 评论中有图片，但截图没有显示？

**A:** Word 中若文字与图片位于同一段落且无换行，图片可能无法正确识别。建议在图片**前后添加换行符**以便正确提取。

---

### Q: 脚本运行失败，窗口一闪而过？

**A:** 使用 CMD 命令行手动运行 `run.bat`，可查看详细错误日志，方便定位问题。

---

## 📮 联系方式

有任何问题或建议欢迎联系作者：

* 📧 邮箱：`825456471@eqq.com`
* 🐙 GitHub Issues：[anime-preview-tool](https://github.com/lizard0126/anime-preview-tool)

---

感谢使用！🎉
如果你觉得本项目有用，欢迎 ⭐Star 支持、反馈建议，一起优化导视流程！
如果你对本项目的html设计有什么建议，也欢迎pr！